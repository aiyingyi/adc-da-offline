package com.adc.da.app;

import com.alibaba.fastjson.JSONObject;
import org.apache.kafka.clients.producer.KafkaProducer;
import org.apache.kafka.clients.producer.ProducerRecord;

import java.util.Properties;

public class Vehicle2Kafka {

    public static void main(String[] args) {
        Properties props = new Properties();
        props.put("bootstrap.servers", "192.168.11.35:9092");//kafka集群，broker-list
        props.put("acks", "all");
        props.put("retries", 1);//重试次数
        props.put("batch.size", 16384);//批次大小
        props.put("linger.ms", 1);//等待时间
        props.put("buffer.memory", 33554432);//RecordAccumulator缓冲区大小
        props.put("key.serializer", "org.apache.kafka.common.serialization.StringSerializer");
        props.put("value.serializer", "org.apache.kafka.common.serialization.StringSerializer");
        KafkaProducer<String, String> producer = new KafkaProducer<>(props);

        String[] str = new String[]{"{\"province\":\"天津市\",\"vin\":\"LGJE13EA8HM612678\",\"vehicleType\": \"EU001\",\"unit\": \"私人\" ,\"licensePlate\":\"津AF59415\",\"batteryType\":\"三元电池\",\"enterprise\":\"CLEYQP8C27\"}",
                "{\"province\":\"天津市\",\"vin\":\"LGJE13EA8HM612679\",\"vehicleType\": \"EU001\",\"unit\": \"私人\" ,\"licensePlate\":\"津AF59416\",\"batteryType\":\"三元电池\",\"enterprise\":\"CLEYQP8C27\"}",
                "{\"province\":\"天津市\",\"vin\":\"LGJE13EA8HM612680\",\"vehicleType\": \"EU001\",\"unit\": \"私人\" ,\"licensePlate\":\"津AF59417\",\"batteryType\":\"三元电池\",\"enterprise\":\"CLEYQP8C27\"}",
                "{\"province\":\"天津市\",\"vin\":\"LGJE13EA8HM612681\",\"vehicleType\": \"EU001\",\"unit\": \"私人\" ,\"licensePlate\":\"津AF59418\",\"batteryType\":\"三元电池\",\"enterprise\":\"CLEYQP8C27\"}",
                "{\"province\":\"天津市\",\"vin\":\"LGJE13EA8HM612682\",\"vehicleType\": \"EU001\",\"unit\": \"私人\" ,\"licensePlate\":\"津AF59419\",\"batteryType\":\"三元电池\",\"enterprise\":\"CLEYQP8C27\"}",
        };

        for (String s : str) {

            //s="{\"averageModuleCellVoltages\":[2.665,2.655,2.653,2.671,2.663,2.666,2.671,2.666,2.661,2.669,2.659,2.662,2.671,2.663,2.657,2.669,2.66,2.665,2.668,2.664,2.66,2.669,2.657,2.66],\"soc\":\"41\",\"averageProbeTemperature\":26.8,\"insulationResistance\":2000.0,\"variation\":[0.28284162677182734,0.28284162677182734,-1.4142146076149136,0.28284162677182734,-1.4142146076149136,-1.4142146076149136,-1.4142146076149136,-1.4142146076149136,-1.4142146076149136,0.28284162677182734,0.28284162677182734,0.28284162677182734,0.28284162677182734,0.28284162677182734,0.28284162677182734,0.28284162677182734,0.28284162677182734,0.28284162677182734,-1.4142146076149136,-1.4142146076149136,0.28284162677182734,0.28284162677182734,0.28284162677182734,1.9798978611585683,1.9798978611585683,1.9798978611585683,0.28284162677182734,0.28284162677182734,0.28284162677182734,0.28284162677182734,0.28284162677182734,0.28284162677182734,0.28284162677182734,0.28284162677182734,0.28284162677182734,0.28284162677182734,0.28284162677182734,0.28284162677182734,-1.4142146076149136,0.28284162677182734,-1.4142146076149136,-1.4142146076149136,-1.4142146076149136,-1.4142146076149136,1.9798978611585683,1.9798978611585683,0.28284162677182734,0.28284162677182734],\"wDischargeRate\":0.0,\"licensePlate\":\"津AF59416\",\"maxProbeTemperature\":28.0,\"minTemperatureRate\":-2.8805493E-8,\"minCellVoltageNum\":0,\"atanMinTemperatureRate\":-2.8805493E-8,\"vin\":\"LGJE13EA8HM612679\",\"vehicleType\":\"EU001\",\"longitude\":30.698553,\"wDifferenceCellVoltages\":[-0.092,-0.095,-0.095,-0.096,-0.15,-0.095,-0.096,-0.092,-0.168,-0.096,-0.099,-0.095,-0.083,-0.092,-0.092,-0.088,-0.143,-0.091,-0.091,-0.088,-0.117,-0.091,-0.09,-0.089,-0.083,-0.09,-0.089,-0.086,-0.115,-0.091,-0.091,-0.087,-0.14,-0.09,-0.09,-0.087,-0.082,-0.091,-0.092,-0.087,-0.156,-0.088,-0.091,-0.088,-0.132,-0.088,-0.091,-0.087,-0.081,-0.089,-0.089,-0.087,-0.132,-0.09,-0.09,-0.086,-0.152,-0.095,-0.094,-0.089,-0.084,-0.091,-0.091,-0.088,-0.143,-0.092,-0.091,-0.088,-0.113,-0.092,-0.092,-0.089,-0.084,-0.095,-0.094,-0.092,-0.115,-0.092,-0.091,-0.088,-0.146,-0.093,-0.093,-0.089,-0.085,-0.093,-0.09,-0.091,-0.165,-0.09,-0.091,-0.089,-0.141,-0.09,-0.094,-0.091],\"probeTemperature\":[27.0,27.0,26.0,27.0,26.0,26.0,26.0,26.0,26.0,27.0,27.0,27.0,27.0,27.0,27.0,27.0,27.0,27.0,26.0,26.0,27.0,27.0,27.0,28.0,28.0,28.0,27.0,27.0,27.0,27.0,27.0,27.0,27.0,27.0,27.0,27.0,27.0,27.0,26.0,27.0,26.0,26.0,26.0,26.0,28.0,28.0,27.0,27.0],\"maxModuleCellVoltages\":[3.554,3.554,3.553,3.564,3.561,3.56,3.562,3.559,3.559,3.561,3.561,3.559,3.563,3.56,3.556,3.562,3.559,3.56,3.563,3.557,3.557,3.561,3.559,3.558],\"minModuleCellVoltageNums\":[2.0,4.0,8.0,13.0,16.0,20.0,25.0,28.0,32.0,38.0,40.0,44.0,49.0,52.0,56.0,61.0,64.0,68.0,73.0,76.0,80.0,85.0,88.0,92.0],\"totalModuleCellVoltages\":[10.661,10.62,10.61,10.684,10.651,10.664,10.683,10.663,10.643,10.676,10.637,10.647,10.683,10.651,10.629,10.678,10.639,10.661,10.673,10.654,10.638,10.677,10.627,10.64],\"cellVoltage\":[3.554,3.554,3.553,3.552,3.517,3.554,3.549,3.557,3.505,3.553,3.552,3.554,3.564,3.56,3.56,3.562,3.529,3.561,3.561,3.562,3.544,3.56,3.56,3.561,3.562,3.56,3.561,3.561,3.546,3.558,3.559,3.562,3.526,3.559,3.558,3.56,3.561,3.558,3.557,3.561,3.518,3.561,3.558,3.559,3.53,3.559,3.558,3.56,3.563,3.56,3.56,3.562,3.532,3.56,3.559,3.562,3.518,3.555,3.556,3.56,3.562,3.558,3.558,3.561,3.524,3.556,3.559,3.561,3.544,3.56,3.557,3.56,3.563,3.553,3.557,3.555,3.54,3.557,3.557,3.56,3.524,3.557,3.557,3.56,3.561,3.557,3.559,3.558,3.509,3.559,3.559,3.559,3.526,3.558,3.556,3.559],\"runMode\":\"1\",\"differenceModuleCellVoltages\":[0.001,0.037,0.048,0.004,0.032,0.016,0.002,0.013,0.033,0.004,0.043,0.029,0.003,0.028,0.038,0.004,0.035,0.016,0.01,0.017,0.033,0.004,0.05,0.032],\"unit\":\"私人\",\"failure\":\"0[]\",\"odo\":9036.7,\"varianceProbeTemperature\":0.3,\"totalVoltage\":341.1,\"minProbeTemperature\":26.0,\"probeNum\":48,\"differenceProbeTemperature\":2.0,\"temperatureRate\":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],\"startupStatus\":\"1\",\"cellNum\":96,\"differenceCellVoltage\":0.059,\"latitude\":114.300255,\"wDifferenceTotalCellVoltage\":-9.446,\"maxTemperatureRate\":-3.4566593E-8,\"minProbeTemperatureNum\":2.0,\"chargeStatus\":\"0\",\"differenceInternalResistance\":0.0,\"speed\":71.2,\"atanMaxTemperatureRate\":-3.4566593E-8,\"entropy\":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],\"totalCurrent\":154.0,\"totalCellVoltage\":341.117,\"suffixName\":\"20180503_10\",\"maxProbeTemperatureNum\":23.0,\"aptv\":62.0,\"differenceModuleProbeTemperature\":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],\"totalProbeTemperature\":1288.0,\"standardDeviationProbeTemperature\":0.6000000238418579,\"maxCellVoltageNum\":12,\"maxModuleCellVoltageNums\":[0.0,5.0,9.0,12.0,17.0,21.0,24.0,30.0,33.0,36.0,41.0,45.0,48.0,53.0,58.0,60.0,66.0,69.0,72.0,77.0,81.0,84.0,89.0,93.0],\"instantaneousConsumption\":-5.3,\"maxCellVoltage\":3.564,\"averageModuleProbeTemperature\":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],\"positionStatus\":\"1\",\"gearStatus\":\"1\",\"averageCellVoltage\":3.553,\"minCellVoltage\":3.505,\"minModuleCellVoltages\":[3.553,3.517,3.505,3.56,3.529,3.544,3.56,3.546,3.526,3.557,3.518,3.53,3.56,3.532,3.518,3.558,3.524,3.544,3.553,3.54,3.524,3.557,3.509,3.526],\"msgTime\":\"20180503 00:16:13\",\"varianceCellVoltage\":0.0,\"batteryType\":\"三元电池\",\"bptv\":0.0}";

            producer.send(new ProducerRecord<String, String>("vehicle", null,s));
            //System.out.println(s);
        }


        producer.close();

    }
}
